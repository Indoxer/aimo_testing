Please reason step by step, and put your final answer within \boxed{}. Provide only one \boxed{}.
 The problem: 
For any finite set $X$, let $| X |$ denote the number of elements in $X$. Define
\[S_n = \sum | A \cap B | ,\]
where the sum is taken over all ordered pairs $(A, B)$ such that $A$ and $B$ are subsets of $\left\{ 1 , 2 , 3,  \cdots , n \right\}$ with $|A| = |B|$.
For example, $S_2 = 4$ because the sum is taken over the pairs of subsets
\[(A, B) \in \left\{ (\emptyset, \emptyset) , ( \{1\} , \{1\} ), ( \{1\} , \{2\} ) , ( \{2\} , \{1\} ) , ( \{2\} , \{2\} ) , ( \{1 , 2\} , \{1 , 2\} ) \right\} ,\]
giving $S_2 = 0 + 1 + 0 + 0 + 1 + 2 = 4$.
Let $\frac{S_{2022}}{S_{2021}} = \frac{p}{q}$, where $p$ and $q$ are relatively prime positive integers. Find the remainder when $p + q$ is divided by
1000.


To solve for \( S_n \), we need to consider the sum of the sizes of the intersections of all pairs of subsets of \(\{1, 2, \ldots, n\}\) of the same size. Let's start by analyzing the contribution of each element \( i \) in the set \(\{1, 2, \ldots, n\}\) to the sum \( S_n \).

For a fixed element \( i \), the number of subsets of \(\{1, 2, \ldots, n\}\) that include \( i \) and have size \( k \) is \(\binom{n-1}{k-1}\). There are \(\binom{n}{k}\) subsets of size \( k \), so the total number of times \( i \) appears in an intersection \( A \cap B \) where \( |A| = |B| = k \) is \(\binom{n-1}{k-1}^2\). Therefore, the contribution of element \( i \) to \( S_n \) is:

\[
\sum_{k=1}^n \binom{n-1}{k-1}^2 = \sum_{j=0}^{n-1} \binom{n-1}{j}^2 = \binom{2(n-1)}{n-1}
\]

This is because the sum of the squares of the binomial coefficients \(\binom{n-1}{k}\) is \(\binom{2(n-1)}{n-1}\). Since there are \( n \) elements in the set, the total sum \( S_n \) is:

\[
S_n = n \binom{2(n-1)}{n-1}
\]

Now, we need to find \( S_{2022} \) and \( S_{2021} \):

\[
S_{2022} = 2022 \binom{4042}{2021}
\]
\[
S_{2021} = 2021 \binom{4042}{2021}
\]

Thus, the ratio \(\frac{S_{2022}}{S_{2021}}\) is:

\[
\frac{S_{2022}}{S_{2021}} = \frac{2022 \binom{4042}{2021}}{2021 \binom{4042}{2021}} = \frac{2022}{2021}
\]

Here, \( p = 2022 \) and \( q = 2021 \), and since 2022 and 2021 are consecutive integers, they are relatively prime. Therefore, \( p + q = 2022 + 2021 = 4043 \). The remainder when 4043 is divided by 1000 is:

\[
4043 \mod 1000 = 43
\]

So, the answer is:

\[
\boxed{43}
\]

Predicted answer: 43.0
Valid answer: 245